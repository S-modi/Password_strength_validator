# -*- coding: utf-8 -*-
"""password_validator.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1rekVbqXF0C7mVt3rPDEpINy6vkbCfx0z
"""

import pandas as pd
import numpy as np

df = pd.read_csv('/content/drive/MyDrive/paswword_strenght.csv', error_bad_lines=False)

df.tail(50)

df['password']

import nltk
import re
nltk.download('stopwords')
from nltk.corpus import stopwords
from nltk.stem.porter import PorterStemmer

df[df['password'].isnull()]

df.dropna(inplace=True)

import seaborn as sns
sns.countplot(df['strength'])

password_tuple=np.array(df)

import random
random.shuffle(password_tuple)

x=[labels[0] for labels in password_tuple]
y=[labels[1] for labels in password_tuple]

def word_divide_char(inputs):
    character=[]
    for i in inputs:
        character.append(i)
    return character

from sklearn.feature_extraction.text import TfidfVectorizer

vectorizer=TfidfVectorizer(max_features=1500)
X=vectorizer.fit_transform(x)

X.shape

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test=train_test_split(X,y,test_size=0.2)

from sklearn.linear_model import LogisticRegression
clf=LogisticRegression(random_state=0,multi_class='multinomial',max_iter=500)
clf.fit(X_train,y_train)

print(clf.score(X_train,y_train))
print(clf.score(X_test,y_test))

y_pred=clf.predict(X_test)
y_pred

import pickle
filename = 'passwo-lr-model.pkl'
pickle.dump(clf, open(filename, 'wb'))

pickle.dump(vectorizer, open('cv-res.pkl', 'wb'))

dt=np.array(['%@123abcd'])
pred=vectorizer.transform(dt)
clf.predict(pred)

y_pred=clf.predict(X_test)
y_pred

